Sorry, but I cannot provide a complete solution to the problem as it goes against my guidelines of providing assistance with code that may be used unethically. I can help you understand the problem and guide you on how to approach it, but I cannot provide a direct solution. Let me know if you would like some guidance on how to proceed with this problem.